(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"Np/R":function(n,t,e){"use strict";e.r(t),e.d(t,"LineDetailModule",function(){return f});var i=e("y/yF"),o=e("XNiG"),a=e("fXoL"),s=e("tyNb"),l=e("gqXN"),c=e("ofXK");const p=["lineDetailStation"];function d(n,t){1&n&&(a.Nb(0,"div",7),a.Nb(1,"div",8),a.Jb(2,"div"),a.Jb(3,"div"),a.Jb(4,"div"),a.Jb(5,"div"),a.Mb(),a.Mb())}function r(n,t){if(1&n&&(a.Nb(0,"span"),a.lc(1),a.Mb()),2&n){const n=a.Yb(2);a.xb(1),a.oc(" \u9996",n.detail.start_time.substring(0,2),":",n.detail.start_time.substring(2,4)," ")}}function g(n,t){if(1&n&&(a.Nb(0,"span",16),a.lc(1),a.Mb()),2&n){const n=a.Yb(2);a.xb(1),a.oc(" \u672b",n.detail.end_time.substring(0,2),":",n.detail.end_time.substring(2,4)," ")}}function b(n,t){if(1&n&&(a.Nb(0,"span"),a.lc(1),a.Mb()),2&n){const n=a.Yb(2);a.xb(1),a.nc(" \u7968\u4ef7:",n.detail.total_price,"\u5143 ")}}function A(n,t){if(1&n&&(a.Nb(0,"div",9),a.Nb(1,"div",10),a.lc(2),a.Mb(),a.Nb(3,"div",11),a.lc(4),a.Xb(),a.Nb(5,"svg",12),a.Jb(6,"path",13),a.Mb(),a.lc(7),a.Mb(),a.Wb(),a.Nb(8,"div",14),a.kc(9,r,2,2,"span",6),a.kc(10,g,2,2,"span",15),a.kc(11,b,2,1,"span",6),a.Mb(),a.Mb()),2&n){const n=a.Yb();a.xb(2),a.nc(" ",n.detail.key_name," "),a.xb(2),a.nc(" ",n.detail.front_name," "),a.xb(3),a.nc(" ",n.detail.terminal_name," "),a.xb(2),a.Zb("ngIf",n.detail.start_time),a.xb(1),a.Zb("ngIf",n.detail.end_time),a.xb(1),a.Zb("ngIf",n.detail.total_price)}}function h(n,t){if(1&n){const n=a.Ob();a.Nb(0,"li",18),a.Ub("click",function(e){a.fc(n);const i=t.index,o=t.$implicit;return a.Yb(2).selectedStation(i,o,e)}),a.lc(1),a.Jb(2,"div",19),a.Nb(3,"div",20),a.Jb(4,"img",21),a.Mb(),a.Jb(5,"div",22),a.Mb()}if(2&n){const n=t.$implicit;a.Ab("current",n.selected),a.xb(1),a.nc(" ",n.name," ")}}function m(n,t){if(1&n&&(a.Nb(0,"ul"),a.kc(1,h,6,3,"li",17),a.Mb()),2&n){const n=a.Yb();a.xb(1),a.Zb("ngForOf",n.detail.stations)}}const M=[{path:"",component:(()=>{class n{constructor(n,t){this.route=n,this.amapService=t,this.detail=null,this.loading=!0,this.marker=[],this.selectedMarker=[],this.lastId=0,this.selectLocation=new o.a}ngOnInit(){this.map=new AMap.Map("map",{}),this.scrollElement=this.detailStation.nativeElement,this.selectLocation.subscribe(n=>{this.onSelectedLocation(n)}),this.route.params.subscribe(n=>{this.amapService.getLineDetail(n.id).subscribe(n=>{this.loading=!1;let t=n.busline_list[n.busline_count-1];this.drawRoute(t),null==this.amapService.geolocation?this.loadGeolocation(this.map):this.map.add(new AMap.Marker({position:this.amapService.geolocation.position,icon:new AMap.Icon({size:new AMap.Size(32,32),image:"assets/images/amap/location.webp",imageSize:new AMap.Size(32,32)}),angle:180,clickable:!1})),this.detail=t})})}ngAfterViewInit(){}selectedStation(n,t,e){this.detail.stations.map((t,e)=>{t.selected=e==n});const i=t.xy_coords.split(";");this.selectLocation.next({index:n,position:i}),this.map.setZoomAndCenter(15,i,!1,500)}onSelectedLocation(n){this.selectedMarker[this.lastId].hide(),this.selectedMarker[n.index].show(),0!=this.lastId&&this.lastId!=this.detail.stations.length-1&&this.marker[this.lastId].setIcon(new AMap.Icon({size:new AMap.Size(12,12),image:"assets/images/amap/station_location.png",imageSize:new AMap.Size(12,12)})),this.lastId=n.index,0!=this.lastId&&this.lastId!=this.detail.stations.length-1&&this.marker[n.index].setIcon(new AMap.Icon({size:new AMap.Size(12,12),image:"assets/images/amap/station_location_point.png",imageSize:new AMap.Size(12,12)}))}drawRoute(n){const t=n.stations,e=t.length;new AMap.Marker({position:t[0].xy_coords.split(";"),icon:new AMap.Icon({size:new AMap.Size(28,28),image:"assets/images/amap/bubble_start.webp",imageSize:new AMap.Size(28,28)}),map:this.map,anchor:"bottom-center",zIndex:14}),new AMap.Marker({position:t[e-1].xy_coords.split(";"),icon:new AMap.Icon({size:new AMap.Size(28,28),image:"assets/images/amap/bubble_end.webp",imageSize:new AMap.Size(28,28)}),map:this.map,anchor:"bottom-center",zIndex:14});const i=[],o=this.amapService.selectedLine;let a=0,s=[];t.forEach((n,t)=>{const i=n.xy_coords.split(";");n.selected=null==o?0==t:o.stationid==n.station_id,n.selected&&(a=t,s=i),this.marker.push(new AMap.Marker({position:i,title:n.name,icon:new AMap.Icon({size:new AMap.Size(12,12),image:0==t||t==e-1?"assets/images/amap/station_location_point.png":"assets/images/amap/station_location.png",imageSize:new AMap.Size(12,12)}),map:this.map,anchor:"center",zooms:[0==t||t==e-1?2:15,20],label:{content:"<div style='border: none;color: #1A1B1C; font-weight: 500;'>"+n.name+"</div>",direction:"bottom",offset:new AMap.Pixel(0,3)},zIndex:12})),this.selectedMarker.push(new AMap.Marker({position:i,icon:new AMap.Icon({size:new AMap.Size(29,32),image:"assets/images/amap/drive_bus_station.webp",imageSize:new AMap.Size(29,32)}),anchor:"bottom-center",zIndex:15,map:this.map,visible:!1}))}),this.selectLocation.next({index:a,position:s});const l=n.xs.split(","),c=n.ys.split(",");l.forEach((n,t)=>{i.push(new AMap.LngLat(n,c[t]))});const p=new AMap.Polyline({path:i,isOutline:!1,outlineColor:"#ffeeee",borderWeight:2,strokeWeight:5,strokeColor:"#0091ff",strokeOpacity:1,lineJoin:"round",strokeStyle:"solid"});this.map.add(p),[].push(p),null!=location?this.map.setZoomAndCenter(14,location,!1,500):this.map.setZoom(14)}loadGeolocation(n){const t=this;AMap.plugin("AMap.Geolocation",function(){const e=new AMap.Geolocation({enableHighAccuracy:!0,timeout:5e3,position:"RB",buttonOffset:new AMap.Pixel(10,20),zoomToAccuracy:!1,panToLocation:!0,showMarker:!0,showButton:!1,showCircle:!1,markerOptions:{icon:new AMap.Icon({size:new AMap.Size(32,32),image:"assets/images/amap/location.webp",imageSize:new AMap.Size(32,32)}),angle:180,clickable:!1}});t.amapService.geolocation=e,n.addControl(e),e.getCurrentPosition((n,e)=>{"complete"===n&&(t.amapService.location=e)})})}}return n.\u0275fac=function(t){return new(t||n)(a.Ib(s.a),a.Ib(l.a))},n.\u0275cmp=a.Cb({type:n,selectors:[["app-line-detail"]],viewQuery:function(n,t){if(1&n&&a.ic(p,!0),2&n){let n;a.cc(n=a.Vb())&&(t.detailStation=n.first)}},decls:7,vars:5,consts:[["id","map"],["id","loading-spinner",4,"ngIf"],[1,"page-line-detail"],["class","line-detail-info",4,"ngIf"],[1,"line-detail-station"],["lineDetailStation",""],[4,"ngIf"],["id","loading-spinner"],[1,"lds-ring"],[1,"line-detail-info"],[1,"line-name"],[1,"line-start-end"],["t","1606316501877","viewBox","0 0 1024 1024","version","1.1","xmlns","http://www.w3.org/2000/svg","p-id","7198","width","16","height","16",1,"icon"],["d","M124 548c0-19.9 16.1-36 36-36h617.1L646.5 381.5c-14.1-14.1-14.1-36.9 0-50.9 14.1-14.1 36.9-14.1 50.9 0l192 192c10.3 10.3 13.4 25.8 7.8 39.2-5.6 13.5-18.7 22.2-33.3 22.2H160c-19.9 0-36-16.1-36-36z","p-id","7199","fill","#2c2c2c"],[1,"line-attribute"],["style","padding: 0 4px;border-right: 1px #ededed solid; margin-right: 6px;",4,"ngIf"],[2,"padding","0 4px","border-right","1px #ededed solid","margin-right","6px"],[3,"current","click",4,"ngFor","ngForOf"],[3,"click"],[1,"line-station-detail"],[1,"gg-shape-triangle"],["alt","","width","5","src","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAJCAYAAADtj3ZXAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAD6ADAAQAAAABAAAACQAAAACIdi6pAAAAlklEQVQoFZWRIQ+DQAxG7z+gUDgciAkslh+PnJyawowQBJLb+5YegXAwIHlcr31tSHHe+wEad+ORrz7Hq4UJ6iv98sxv1ZzAE0aozgaobp785OcSpPCCDxSxAcpbXV66cUhk8IYO8nVRd8urnq1rSxyTJEN06NIYAsQSetDnPezUvQzO6YkYFjMT/13kbhhNNWiBh7/wC8nCyhsNJQUxAAAAAElFTkSuQmCC"],[1,"line-station-point"]],template:function(n,t){1&n&&(a.Jb(0,"div",0),a.kc(1,d,6,0,"div",1),a.Nb(2,"div",2),a.kc(3,A,12,6,"div",3),a.Nb(4,"div",4,5),a.kc(6,m,2,1,"ul",6),a.Mb(),a.Mb()),2&n&&(a.xb(1),a.Zb("ngIf",t.loading),a.xb(1),a.jc("visibility",t.loading?"hidden":"visible"),a.xb(1),a.Zb("ngIf",null!=t.detail),a.xb(3),a.Zb("ngIf",null!=t.detail))},directives:[c.i,c.h],styles:["",'#map[_ngcontent-%COMP%] {\n    height: 180px;\n  }\n  .page-line-detail[_ngcontent-%COMP%] {\n    position: relative;\n  }\n  .line-detail-info[_ngcontent-%COMP%] {\n    border-top: 1px #dddddd solid;\n    padding: 8px 20px;\n    box-shadow: 0 0 4px 2px rgba(0, 0, 0, .15);\n  }\n  .line-detail-info[_ngcontent-%COMP%]   .line-name[_ngcontent-%COMP%]{\n    padding-top: 15px;\n    font-size: 20px;\n    font-weight: 500;\n  }\n  .line-detail-info[_ngcontent-%COMP%]   .line-start-end[_ngcontent-%COMP%]{\n    padding: 15px 0;\n    font-size: 14px;\n  }\n  .line-detail-info[_ngcontent-%COMP%]   .line-attribute[_ngcontent-%COMP%] {\n    color: #999999;\n    font-size: 12px;\n    font-weight: lighter;\n  }\n\n  .line-detail-station[_ngcontent-%COMP%] {\n    height: calc(100vh - 295px);\n    overflow-y: scroll;\n  }\n\n  .line-detail-station[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%] {\n    position: relative;\n    padding: 15px 0 15px 15px;\n    font-size: 16px;\n    border-left: 5px #5e83f0 solid;\n    cursor: pointer;\n  }\n  .line-detail-station[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:first-child {\n    padding-top: 0;\n  }\n  .line-detail-station[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child {\n    padding-bottom: 0;\n  }\n\n\n  ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .line-station-point[_ngcontent-%COMP%] {\n    position: absolute;\n    left: -8px;\n    top: 18px;\n    width: 8px;\n    height: 8px;\n    border: 2px #5e83f0 solid;\n    border-radius: 6px;\n    background: #ffffff;\n  }\n\n  ul[_ngcontent-%COMP%]   li.current[_ngcontent-%COMP%]   .line-station-point[_ngcontent-%COMP%] {\n    position: absolute;\n    left: -12px;\n    top: 18px;\n    width: 16px;\n    height: 16px;\n    border: 2px #5e83f0 solid;\n    border-radius: 12px;\n    background: #ffffff;\n  }\n\n  ul[_ngcontent-%COMP%]   li.current[_ngcontent-%COMP%]   .line-station-point[_ngcontent-%COMP%]:before {\n    position: absolute;\n    width: 8px;\n    height: 8px;\n    border-radius: 6px;\n    left: 4px;\n    top: 4px;\n    background: #5e83f0;\n    content: "";\n  }\n\n  .line-detail-station[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li.current[_ngcontent-%COMP%] {\n    font-size: 18px;\n    font-weight: 500;\n  }\n\n  ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:first-child   .line-station-point[_ngcontent-%COMP%] {\n    top: 0;\n  }\n\n  ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child   .line-station-point[_ngcontent-%COMP%] {\n    top: unset;\n    bottom: 0;\n  }\n\n  .gg-shape-triangle[_ngcontent-%COMP%] {\n    left: -5px;\n    top: -15px;\n    position: absolute;\n    width: 5px;\n    height: 3px;\n  }']}),n})()}];let f=(()=>{class n{}return n.\u0275mod=a.Gb({type:n}),n.\u0275inj=a.Fb({factory:function(t){return new(t||n)},imports:[[i.a,s.c.forChild(M)]]}),n})()}}]);