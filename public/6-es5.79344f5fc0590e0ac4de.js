!function(){function n(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function t(n,t){for(var e=0;e<t.length;e++){var i=t[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"Np/R":function(e,i,a){"use strict";a.r(i),a.d(i,"LineDetailModule",function(){return v});var o=a("y/yF"),s=a("XNiG"),l=a("fXoL"),c=a("tyNb"),p=a("gqXN"),r=a("ofXK"),d=["lineDetailStation"];function g(n,t){1&n&&(l.Nb(0,"div",7),l.Nb(1,"div",8),l.Jb(2,"div"),l.Jb(3,"div"),l.Jb(4,"div"),l.Jb(5,"div"),l.Mb(),l.Mb())}function b(n,t){if(1&n&&(l.Nb(0,"span"),l.lc(1),l.Mb()),2&n){var e=l.Yb(2);l.xb(1),l.oc(" \u9996",e.detail.start_time.substring(0,2),":",e.detail.start_time.substring(2,4)," ")}}function A(n,t){if(1&n&&(l.Nb(0,"span",16),l.lc(1),l.Mb()),2&n){var e=l.Yb(2);l.xb(1),l.oc(" \u672b",e.detail.end_time.substring(0,2),":",e.detail.end_time.substring(2,4)," ")}}function u(n,t){if(1&n&&(l.Nb(0,"span"),l.lc(1),l.Mb()),2&n){var e=l.Yb(2);l.xb(1),l.nc(" \u7968\u4ef7:",e.detail.total_price,"\u5143 ")}}function f(n,t){if(1&n&&(l.Nb(0,"div",9),l.Nb(1,"div",10),l.lc(2),l.Mb(),l.Nb(3,"div",11),l.lc(4),l.Xb(),l.Nb(5,"svg",12),l.Jb(6,"path",13),l.Mb(),l.lc(7),l.Mb(),l.Wb(),l.Nb(8,"div",14),l.kc(9,b,2,2,"span",6),l.kc(10,A,2,2,"span",15),l.kc(11,u,2,1,"span",6),l.Mb(),l.Mb()),2&n){var e=l.Yb();l.xb(2),l.nc(" ",e.detail.key_name," "),l.xb(2),l.nc(" ",e.detail.front_name," "),l.xb(3),l.nc(" ",e.detail.terminal_name," "),l.xb(2),l.Zb("ngIf",e.detail.start_time),l.xb(1),l.Zb("ngIf",e.detail.end_time),l.xb(1),l.Zb("ngIf",e.detail.total_price)}}function h(n,t){if(1&n){var e=l.Ob();l.Nb(0,"li",18),l.Ub("click",function(n){l.fc(e);var i=t.index,a=t.$implicit;return l.Yb(2).selectedStation(i,a,n)}),l.lc(1),l.Jb(2,"div",19),l.Nb(3,"div",20),l.Jb(4,"img",21),l.Mb(),l.Jb(5,"div",22),l.Mb()}if(2&n){var i=t.$implicit;l.Ab("current",i.selected),l.xb(1),l.nc(" ",i.name," ")}}function m(n,t){if(1&n&&(l.Nb(0,"ul"),l.kc(1,h,6,3,"li",17),l.Mb()),2&n){var e=l.Yb();l.xb(1),l.Zb("ngForOf",e.detail.stations)}}var M,x,w=[{path:"",component:(M=function(){function e(t,i){n(this,e),this.route=t,this.amapService=i,this.detail=null,this.loading=!0,this.marker=[],this.selectedMarker=[],this.lastId=0,this.selectLocation=new s.a}var i,a,o;return i=e,(a=[{key:"ngOnInit",value:function(){var n=this;this.map=new AMap.Map("map",{}),this.scrollElement=this.detailStation.nativeElement,this.selectLocation.subscribe(function(t){n.onSelectedLocation(t)}),this.route.params.subscribe(function(t){n.amapService.getLineDetail(t.id).subscribe(function(t){n.loading=!1;var e=t.busline_list[t.busline_count-1];n.drawRoute(e),null==n.amapService.geolocation?n.loadGeolocation(n.map):n.map.add(new AMap.Marker({position:n.amapService.geolocation.position,icon:new AMap.Icon({size:new AMap.Size(32,32),image:"assets/images/amap/location.webp",imageSize:new AMap.Size(32,32)}),angle:180,clickable:!1})),n.detail=e})})}},{key:"ngAfterViewInit",value:function(){}},{key:"selectedStation",value:function(n,t,e){this.detail.stations.map(function(t,e){t.selected=e==n});var i=t.xy_coords.split(";");this.selectLocation.next({index:n,position:i}),this.map.setZoomAndCenter(15,i,!1,500)}},{key:"onSelectedLocation",value:function(n){this.selectedMarker[this.lastId].hide(),this.selectedMarker[n.index].show(),0!=this.lastId&&this.lastId!=this.detail.stations.length-1&&this.marker[this.lastId].setIcon(new AMap.Icon({size:new AMap.Size(12,12),image:"assets/images/amap/station_location.png",imageSize:new AMap.Size(12,12)})),this.lastId=n.index,0!=this.lastId&&this.lastId!=this.detail.stations.length-1&&this.marker[n.index].setIcon(new AMap.Icon({size:new AMap.Size(12,12),image:"assets/images/amap/station_location_point.png",imageSize:new AMap.Size(12,12)}))}},{key:"drawRoute",value:function(n){var t=this,e=n.stations,i=e.length;new AMap.Marker({position:e[0].xy_coords.split(";"),icon:new AMap.Icon({size:new AMap.Size(28,28),image:"assets/images/amap/bubble_start.webp",imageSize:new AMap.Size(28,28)}),map:this.map,anchor:"bottom-center",zIndex:14}),new AMap.Marker({position:e[i-1].xy_coords.split(";"),icon:new AMap.Icon({size:new AMap.Size(28,28),image:"assets/images/amap/bubble_end.webp",imageSize:new AMap.Size(28,28)}),map:this.map,anchor:"bottom-center",zIndex:14});var a=[],o=this.amapService.selectedLine,s=0,l=[];e.forEach(function(n,e){var a=n.xy_coords.split(";");n.selected=null==o?0==e:o.stationid==n.station_id,n.selected&&(s=e,l=a),t.marker.push(new AMap.Marker({position:a,title:n.name,icon:new AMap.Icon({size:new AMap.Size(12,12),image:0==e||e==i-1?"assets/images/amap/station_location_point.png":"assets/images/amap/station_location.png",imageSize:new AMap.Size(12,12)}),map:t.map,anchor:"center",zooms:[0==e||e==i-1?2:15,20],label:{content:"<div style='border: none;color: #1A1B1C; font-weight: 500;'>"+n.name+"</div>",direction:"bottom",offset:new AMap.Pixel(0,3)},zIndex:12})),t.selectedMarker.push(new AMap.Marker({position:a,icon:new AMap.Icon({size:new AMap.Size(29,32),image:"assets/images/amap/drive_bus_station.webp",imageSize:new AMap.Size(29,32)}),anchor:"bottom-center",zIndex:15,map:t.map,visible:!1}))}),this.selectLocation.next({index:s,position:l});var c=n.xs.split(","),p=n.ys.split(",");c.forEach(function(n,t){a.push(new AMap.LngLat(n,p[t]))});var r=new AMap.Polyline({path:a,isOutline:!1,outlineColor:"#ffeeee",borderWeight:2,strokeWeight:5,strokeColor:"#0091ff",strokeOpacity:1,lineJoin:"round",strokeStyle:"solid"});this.map.add(r),[].push(r),null!=location?this.map.setZoomAndCenter(14,location,!1,500):this.map.setZoom(14)}},{key:"loadGeolocation",value:function(n){var t=this;AMap.plugin("AMap.Geolocation",function(){var e=new AMap.Geolocation({enableHighAccuracy:!0,timeout:5e3,position:"RB",buttonOffset:new AMap.Pixel(10,20),zoomToAccuracy:!1,panToLocation:!0,showMarker:!0,showButton:!1,showCircle:!1,markerOptions:{icon:new AMap.Icon({size:new AMap.Size(32,32),image:"assets/images/amap/location.webp",imageSize:new AMap.Size(32,32)}),angle:180,clickable:!1}});t.amapService.geolocation=e,n.addControl(e),e.getCurrentPosition(function(n,e){"complete"===n&&(t.amapService.location=e)})})}}])&&t(i.prototype,a),o&&t(i,o),e}(),M.\u0275fac=function(n){return new(n||M)(l.Ib(c.a),l.Ib(p.a))},M.\u0275cmp=l.Cb({type:M,selectors:[["app-line-detail"]],viewQuery:function(n,t){var e;1&n&&l.ic(d,!0),2&n&&l.cc(e=l.Vb())&&(t.detailStation=e.first)},decls:7,vars:5,consts:[["id","map"],["id","loading-spinner",4,"ngIf"],[1,"page-line-detail"],["class","line-detail-info",4,"ngIf"],[1,"line-detail-station"],["lineDetailStation",""],[4,"ngIf"],["id","loading-spinner"],[1,"lds-ring"],[1,"line-detail-info"],[1,"line-name"],[1,"line-start-end"],["t","1606316501877","viewBox","0 0 1024 1024","version","1.1","xmlns","http://www.w3.org/2000/svg","p-id","7198","width","16","height","16",1,"icon"],["d","M124 548c0-19.9 16.1-36 36-36h617.1L646.5 381.5c-14.1-14.1-14.1-36.9 0-50.9 14.1-14.1 36.9-14.1 50.9 0l192 192c10.3 10.3 13.4 25.8 7.8 39.2-5.6 13.5-18.7 22.2-33.3 22.2H160c-19.9 0-36-16.1-36-36z","p-id","7199","fill","#2c2c2c"],[1,"line-attribute"],["style","padding: 0 4px;border-right: 1px #ededed solid; margin-right: 6px;",4,"ngIf"],[2,"padding","0 4px","border-right","1px #ededed solid","margin-right","6px"],[3,"current","click",4,"ngFor","ngForOf"],[3,"click"],[1,"line-station-detail"],[1,"gg-shape-triangle"],["alt","","width","5","src","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAJCAYAAADtj3ZXAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAD6ADAAQAAAABAAAACQAAAACIdi6pAAAAlklEQVQoFZWRIQ+DQAxG7z+gUDgciAkslh+PnJyawowQBJLb+5YegXAwIHlcr31tSHHe+wEad+ORrz7Hq4UJ6iv98sxv1ZzAE0aozgaobp785OcSpPCCDxSxAcpbXV66cUhk8IYO8nVRd8urnq1rSxyTJEN06NIYAsQSetDnPezUvQzO6YkYFjMT/13kbhhNNWiBh7/wC8nCyhsNJQUxAAAAAElFTkSuQmCC"],[1,"line-station-point"]],template:function(n,t){1&n&&(l.Jb(0,"div",0),l.kc(1,g,6,0,"div",1),l.Nb(2,"div",2),l.kc(3,f,12,6,"div",3),l.Nb(4,"div",4,5),l.kc(6,m,2,1,"ul",6),l.Mb(),l.Mb()),2&n&&(l.xb(1),l.Zb("ngIf",t.loading),l.xb(1),l.jc("visibility",t.loading?"hidden":"visible"),l.xb(1),l.Zb("ngIf",null!=t.detail),l.xb(3),l.Zb("ngIf",null!=t.detail))},directives:[r.i,r.h],styles:["",'#map[_ngcontent-%COMP%] {\n    height: 180px;\n  }\n  .page-line-detail[_ngcontent-%COMP%] {\n    position: relative;\n  }\n  .line-detail-info[_ngcontent-%COMP%] {\n    border-top: 1px #dddddd solid;\n    padding: 8px 20px;\n    box-shadow: 0 0 4px 2px rgba(0, 0, 0, .15);\n  }\n  .line-detail-info[_ngcontent-%COMP%]   .line-name[_ngcontent-%COMP%]{\n    padding-top: 15px;\n    font-size: 20px;\n    font-weight: 500;\n  }\n  .line-detail-info[_ngcontent-%COMP%]   .line-start-end[_ngcontent-%COMP%]{\n    padding: 15px 0;\n    font-size: 14px;\n  }\n  .line-detail-info[_ngcontent-%COMP%]   .line-attribute[_ngcontent-%COMP%] {\n    color: #999999;\n    font-size: 12px;\n    font-weight: lighter;\n  }\n\n  .line-detail-station[_ngcontent-%COMP%] {\n    height: calc(100vh - 295px);\n    overflow-y: scroll;\n  }\n\n  .line-detail-station[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%] {\n    position: relative;\n    padding: 15px 0 15px 15px;\n    font-size: 16px;\n    border-left: 5px #5e83f0 solid;\n    cursor: pointer;\n  }\n  .line-detail-station[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:first-child {\n    padding-top: 0;\n  }\n  .line-detail-station[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child {\n    padding-bottom: 0;\n  }\n\n\n  ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .line-station-point[_ngcontent-%COMP%] {\n    position: absolute;\n    left: -8px;\n    top: 18px;\n    width: 8px;\n    height: 8px;\n    border: 2px #5e83f0 solid;\n    border-radius: 6px;\n    background: #ffffff;\n  }\n\n  ul[_ngcontent-%COMP%]   li.current[_ngcontent-%COMP%]   .line-station-point[_ngcontent-%COMP%] {\n    position: absolute;\n    left: -12px;\n    top: 18px;\n    width: 16px;\n    height: 16px;\n    border: 2px #5e83f0 solid;\n    border-radius: 12px;\n    background: #ffffff;\n  }\n\n  ul[_ngcontent-%COMP%]   li.current[_ngcontent-%COMP%]   .line-station-point[_ngcontent-%COMP%]:before {\n    position: absolute;\n    width: 8px;\n    height: 8px;\n    border-radius: 6px;\n    left: 4px;\n    top: 4px;\n    background: #5e83f0;\n    content: "";\n  }\n\n  .line-detail-station[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li.current[_ngcontent-%COMP%] {\n    font-size: 18px;\n    font-weight: 500;\n  }\n\n  ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:first-child   .line-station-point[_ngcontent-%COMP%] {\n    top: 0;\n  }\n\n  ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child   .line-station-point[_ngcontent-%COMP%] {\n    top: unset;\n    bottom: 0;\n  }\n\n  .gg-shape-triangle[_ngcontent-%COMP%] {\n    left: -5px;\n    top: -15px;\n    position: absolute;\n    width: 5px;\n    height: 3px;\n  }']}),M)}],v=((x=function t(){n(this,t)}).\u0275mod=l.Gb({type:x}),x.\u0275inj=l.Fb({factory:function(n){return new(n||x)},imports:[[o.a,c.c.forChild(w)]]}),x)}}])}();